Untested, still working on it.